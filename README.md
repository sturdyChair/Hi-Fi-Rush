# DirectX11 모작 팀 포트폴리오 : Hi-Fi-Rush
TODO : 여기에 타이틀 이미지 삽입

리소스가 포함되어있지 않은 코드 공개용 리포지토리입니다. 정상적으로 동작하지 않을 가능성이 매우 높습니다.

개발 기간 : 2024.09 ~ 2024.11

장르 : 3인칭 리듬 액션 어드벤처

기술 스택:
C, C++, STL, FMOD, Win API, OpenCV, DLL, DirectX 11, vcpkg, HLSL, Effects11, Assimp, ImGui, ImGuizmo, DirectXTK, DirectMath, Nvidia PhysX 5.3 , DLL

역할 : 프레임워커, TA (이펙트, 셰이더)

담당 : 프레임워크, 외부 라이브러리 이식, 카메라, 이펙트 다수, L.I.F.T, 케일 반달레이

---

## 시연 영상 링크 

[Hi-Fi-Rush 전체 프로젝트 영상](https://www.youtube.com/watch?v=rwTkUgP4ITA)

[Hi-Fi-Rush 개인 작업 영상](https://youtu.be/1qcnJ9FaIY8)

---

## 목적 및 설명
포트폴리오 제작, 협업 경험을 위해 개발된 3인칭 리듬 액션 어드벤처 게임 Hi-Fi-Rush의 모작 프로젝트입니다.
상용 엔진을 이용하지 않았으며 DirectX11을 이용해 개발한 엔진을 DLL 프로젝트로 클라이언트 프로젝트에 Export하여 개발했습니다.
제가 담당한 파트는 프레임워크, 외부 라이브러리 이식, 카메라, 이펙트, L.I.F.T(터널 맵), 케일 반달레이(보스)입니다.

---

## 주요 구현 기능

- [Hi-Fi-Rush 개인 작업 영상](https://youtu.be/1qcnJ9FaIY8) 상단 영상에 상세한 설명 있음

## 1. DirectX 11 기반 렌더링 엔진
### 렌더링
- **디퍼드 라이팅**: 연산 부하를 줄이기 위해 G-Buffer 활용
  - G-Buffer 데이터: `Color`, `Id`, `Position`, `Normal`, `Emissive`.
    > `Id`버퍼는 픽셀 피킹 등 개발 편의성을 위해 마련됨
    > 
    > G-Buffer 데이터를 이용해 다양한 셰이더 효과를 구현
- **카툰 렌더링**: 
  - **셀 셰이딩**을 사용한 단계별 음영 처리
  - **외곽선**을 이용한 강조 효과
    >Animated 모델: 동일 모델을 2회 Draw하며 정면 컬링과 정점 확장을 이용해 외곽선 구현
    >
    >Non-Animated 모델: 라플라스 필터와 `Normal`렌더 타겟을 이용, 디퍼드 라이팅 단계에서 외곽선 처리

---

## 2. 최적화 작업
### Assimp 라이브러리 활용
- **FBX 데이터 처리**:
  - 모델 데이터를 구조체로 선언, 구조체를 **이진 직렬화**하여 파일로 저장
  - 전처리 과정이 끝난 FBX파일은 더이상 사용하지 않으며 이진화된 파일을 이용
  - Texture Caching을 통해 동일 텍스쳐의 중복 로딩 방지
  - 멀티 스레딩을 이용한 병렬 로딩
- **로딩 시간 단축**:
  - 결과적으로 30분 이상이었던 로딩 시간을 2분까지 단축
  - 주로 **이진 직렬화**에서 효과를 봄(30분->5분)
  - Texture Caching 작업과 함께 불필요하게 공간을 차지하고 있던 데이터 또한 정리, 메모리 사용량을 2GB 가량 절약하고 로딩 시간 또한 기존 5분에서 3분까지 단축시킴
  - 멀티 스레딩을 이용해 CPU 점유율을 끌어올리고 최종적으로 로딩 시간을 2분까지 단축

---

## 3. 충돌 처리
### PhysX 엔진
- 지형과 캐릭터의 상호작용, 충돌 관리
- **메쉬 콜라이더**:
  - 메쉬와 동일한 모양의 충돌체, 주로 지형에 사용됨
  - PhysX 엔진에 메쉬의 정점 정보를 전달해 만들어짐
- **Character Controller(CCT)**:
  - 캡슐 모양의 충돌체
  - PhysX로 구성된 지형과 상호작용하기 위해 **움직이는 객체**가 가지고 있는 Component 객체
  - 주로 플레이어, 몬스터 AI등이 소유하고 있으며 이동을 제어함
### Collision Manager
- 전투, 상호작용, 이벤트 처리 등 게임 로직에 필요한 충돌 처리를 담당하는 객체
- 충돌 처리가 필요한 객체는 Collider Component를 소유, 매 프레임 Collider를 Collision Manager에 등록함
- 등록되지 않은 Collider는 유효하지 않은 것으로 판별, 그 프레임에서 충돌 처리를 하지 않음
- Collider는 Collision Group으로 나뉘며 그룹 기반으로 충돌 검사 시행
- 각 Collider가 가지고 있는 고유 ID를 이용해 각 Collider 쌍의 충돌 상태를 저장함
  
---

## 4. 이펙트 프레임워크
### Effect Manager
- **객체 관리**:
  - State를 이용한 LifeCycle 관리, 재생 속도 조절
  - shared_ptr의 레퍼런스 관리 기능을 이용, 메모리 할당과 해제 없이 이펙트 객체 재사용
  - `Union Effect`로 여러 이펙트를 통합 및 관리
- **툴 지원**:
  - ImGui 및 Imguizmo 라이브러리를 사용한 편집 기능 제공
  - UV좌표, 컬러, 재생률, 수명, 크기 등 다양한 정보를 수정 및 확인 가능
### Screen Space Decal
- Decal Box가 그려질 픽셀에 대해 World → Local 공간 변환, G-Buffer의 정보를 이용해 내부에만 Decal 적용
### 파티클
- **Point Instancing**:
  - 각 Point의 생성 범위와 Pivot을 설정해 다양한 효과 연출 가능
 
---

## 5. 보스 AI & 연출
### 케일 반달레이 보스전
- **이펙트 & 사운드**:
  - 모델 애니메이션의 연동으로 키프레임 기반 VFX, SFX 관리
- **4단계 페이즈**:
  - 특정 캐릭터와 상호작용 및 약점 공략 가능
  - 페이즈 변경에 따른 이벤트 처리, 특수 연출
  - 페이즈에 따라 BGM 변경, 리듬 처리 초기화
- **AI 설계**:
  - 패턴에 기반한 거리 조절 AI
  - 루트 애니메이션 기반 이동 로직
  - 슈퍼아머 게이지와 그로기 상태 구현
### 연출
- **Screen Space Reflection, Cubemap Reflection**:
  - G-Buffer 데이터를 활용해 반사 구현, 매끈한 제질의 바닥 연출
- **Rhythm Parry**:
  - 모델의 특정 Bone과 카메라 행렬을 동기화해 역동적인 카메라 연출
  - 음악의 리듬에 맞춰 공격을 방어하는 것에 성공해야 다음 페이즈로 넘어가도록 설계
- **Cinematic**:
  - 페이즈 변경에 따라 인게임 시네마틱을 재생하도록 구현
 

